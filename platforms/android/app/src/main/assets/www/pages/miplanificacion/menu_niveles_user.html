<template>
    <div class="page">
        <div class="ap_fondo_2">
            <div class="row">
                <div class="col text-align-center" style="margin-top:52px;">
                    <img class="divUserImgInfo ap_circle" src="images/avatar.png" onerror="this.src='images/logos/logo512.jpg'" alt="Usuario" />
                </div>
            </div>
        </div>         

        <div class="navbar">
            <div class="navbar-inner sliding">
                <div class="left">
                    <a href="#" class="link back">
                        <i class="f7-icons">arrow_left</i>
                    </a>
                </div>
                <div class="title center"> <a href="/" class="link"><img src="images/logos/logo-h.png" class="ap_logo-h"></a> </div>
                <div class="right">
                    <a href="#" data-id="0" id="btnEditMiCLoud" class="link" onclick="modeEditMiCloud(this, 'NIVELES');"><i class="icon f7-icons">compose_fill</i></a>
                    <a href="#" data-id="0" id="btnAddMiCLoud" class="link" onclick="addMiCloud(this, 'NIVELES');"><i class="icon f7-icons">add_round</i></a>
                </div>
            </div>
        </div>

        <div class="page-content" style="padding:10px;padding-top:150px;">
            <div class="card">
                <div class="card-content card-content-padding">
                    <h1 class="text-align-center h1" style="color:#383838;">Mis Niveles</h1>
                </div>
            </div>

            <div class="block">
                <div class="card" style="margin-top:40px;">
                    <div class="card-content card-content-padding">
                        <div class="list">
                            <ul id="divMenuPlanificacionNivelesUser">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>
<script>
    return {
        on: { pageInit: function(e, page) { loadMenu(page.route.params.idc); } }
    }

    function loadMenu(ID){
        var API_USER = localStorage.getItem("LS_USER_API_KEY");
        localStorage.setItem("LS_USER_CLOUD_IDs", ID);
        $("#btnEditMiCLoud").attr("data-id", ID);
        $("#btnAddMiCLoud").attr("data-id", ID);

        var HTML = "";
        $.ajax({
            type: "GET",
            headers: {"Authorization": API_USER},
            url: URL_SERVER+"planificacionUser/"+ID+"/0",
            dataType: 'json',
            success: function (data){
                if(data.PLANIFICACION == ""){
                    HTML = "<li> <p style=\"text-align:center;\">Crea un nuevo nivel en el boton <b>+</b></p> </li>";
                }else{
                    $.each(data.PLANIFICACION, function(index, item) {
                        HTML += "<li>";
                        HTML += "<a href=\"/MAIN-TRIMESTRES-USER/"+ item.id +"/1/\" data-view=\".view-main\" class=\"item-link item-content\" onclick=\"localStorage.setItem('LS_TXT_NIVEL_USER_ID', '"+ item.id +"'); localStorage.setItem('LS_TXT_NIVEL_USER', '"+ item.titulo +"');\">";                              
                        HTML += "<div class=\"item-media\"><i class=\"f7-icons\">collection</i></div>";
                        HTML += "<div class=\"item-inner\">";
                        HTML += "<div class=\"item-title\">"+ item.titulo +"</div>";
                        HTML += "</div>";
                        HTML += "</a>";
                        HTML += "</li>";
                    }); 
                }  
                
                $("#divMenuPlanificacionNivelesUser").html(HTML);
            }
        });                  
    }
</script>